<!DOCTYPE html>
<html>

<head>
    <meta charset=utf-8>
    <meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
    <title>shop</title>
    <link href=./static/css/app.555b0188a5841564f4c3956378a1ce77.css rel=stylesheet>
</head>

<body>
    <p>
        <button id="locationAfterHttp" >locationAfterHttp</button>
    </p>
    <p>
        <button id="locationBeforeHttp" >locationBeforeHttp</button>
    </p>
    <iframe id="geoPage" width=0 height=0 frameborder=0  style="display:none;" scrolling="no"
    src="https://apis.map.qq.com/tools/geolocation?key=OB4BZ-D4W3U-B7VVO-4PJWW-6TKDJ-WPB77&referer=myapp">
    </iframe>
    <script>
        document.getElementById('locationAfterHttp').addEventListener('click', function () {
            var img = document.createElement('img')
            img.src = "http://img.mp.itc.cn/upload/20160415/43ba06629ee0493cb6784a7455cb5cc5.jpg"
            document.body.append(img)
            img.onload = function () {
                navigator.geolocation.getCurrentPosition(function (position) {
                    alert('location succ')
                    console.log(position)

                }, function (error) {
                    alert('location error')
                    console.log(error)
                })
            }
        })
        document.getElementById('locationBeforeHttp').addEventListener('click', function () {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    console.log(position)
                    alert('location succ')
                    var img = document.createElement('img')
                    img.src = "http://img.mp.itc.cn/upload/20160415/43ba06629ee0493cb6784a7455cb5cc5.jpg"
                    document.body.append(img)
                }, function (error) {
                    console.log(error)
                    alert('location error')
                    var img = document.createElement('img')
                    img.src = "http://img.mp.itc.cn/upload/20160415/43ba06629ee0493cb6784a7455cb5cc5.jpg"
                    document.body.append(img)
                })
            } else {
                alert('no location')
            }
        })

        window.addEventListener('message', function(event) {
            alert(JSON.stringify(event.data))
            console.log(event)
            var img = document.createElement('img')
            img.src = "http://img.mp.itc.cn/upload/20160415/43ba06629ee0493cb6784a7455cb5cc5.jpg"
            document.body.append(img)
        })

        // setTimeout(() => {
        //     var img = document.createElement('img')
        //     img.src = "https://note.youdao.com/yws/api/personal/file/2C958F9BC6764B33B5E7238D7BD569A0?method=download&shareKey=ff59b39f98957af033613f9623954709"
        //     document.body.append(img)
        // }, 3000)
    </script>
</body>